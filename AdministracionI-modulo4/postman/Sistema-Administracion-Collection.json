{
  "info": {
    "name": "Sistema Administraci√≥n - Microservicios + RabbitMQ",
    "description": "Colecci√≥n completa para probar GraphQL, RabbitMQ y el sistema de microservicios",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "üî• GRAPHQL - CRUD COMPLETO",
      "item": [
        {
          "name": "üìä Estad√≠sticas Generales",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"query\": \"query { estadisticas { totalEmpleados totalVehiculos totalSucursales totalUsuarios vehiculosPorEstado { estado count } } }\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/graphql",
              "host": ["{{base_url}}"],
              "path": ["graphql"]
            }
          }
        },
        {
          "name": "üë• Listar Todos los Empleados",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"query\": \"query { empleados { id_empleado nombre cargo correo telefono created_at } }\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/graphql",
              "host": ["{{base_url}}"],
              "path": ["graphql"]
            }
          }
        },
        {
          "name": "üöó Listar Todos los Veh√≠culos",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"query\": \"query { vehiculos { id_vehiculo placa marca modelo anio tipo_id estado created_at } }\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/graphql",
              "host": ["{{base_url}}"],
              "path": ["graphql"]
            }
          }
        },
        {
          "name": "üè¢ Listar Todas las Sucursales",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"query\": \"query { sucursales { id_sucursal nombre direccion ciudad telefono created_at } }\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/graphql",
              "host": ["{{base_url}}"],
              "path": ["graphql"]
            }
          }
        },
        {
          "name": "üë§ Listar Todos los Usuarios",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"query\": \"query { users { id name email email_verified_at created_at rol { nombre descripcion } } }\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/graphql",
              "host": ["{{base_url}}"],
              "path": ["graphql"]
            }
          }
        },
        {
          "name": "üîó Listar Asignaciones Veh√≠culo-Sucursal",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"query\": \"query { vehiculoSucursales { id id_vehiculo id_sucursal fecha_asignacion vehiculo { placa marca modelo } sucursal { nombre ciudad } } }\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/graphql",
              "host": ["{{base_url}}"],
              "path": ["graphql"]
            }
          }
        }
      ]
    },
    {
      "name": "‚úÖ MUTATIONS - CREAR DATOS",
      "item": [
        {
          "name": "‚ûï Crear Empleado",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"query\": \"mutation CrearEmpleado($input: EmpleadoInput!) { crearEmpleado(input: $input) { id_empleado nombre cargo correo telefono created_at } }\",\n  \"variables\": {\n    \"input\": {\n      \"nombre\": \"Juan Carlos\",\n      \"apellido\": \"P√©rez Garc√≠a\",\n      \"dni\": \"12345678\",\n      \"telefono\": \"987654321\",\n      \"id_rol\": \"1\"\n    }\n  }\n}"
            },
            "url": {
              "raw": "{{base_url}}/graphql",
              "host": ["{{base_url}}"],
              "path": ["graphql"]
            }
          }
        },
        {
          "name": "‚ûï Crear Veh√≠culo",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"query\": \"mutation CrearVehiculo($input: VehiculoInput!) { crearVehiculo(input: $input) { id_vehiculo placa marca modelo anio tipo_id estado created_at } }\",\n  \"variables\": {\n    \"input\": {\n      \"placa\": \"ABC-1234\",\n      \"marca\": \"Toyota\",\n      \"modelo\": \"Corolla\",\n      \"anio\": 2023,\n      \"tipo_id\": \"sedan\",\n      \"estado\": \"disponible\"\n    }\n  }\n}"
            },
            "url": {
              "raw": "{{base_url}}/graphql",
              "host": ["{{base_url}}"],
              "path": ["graphql"]
            }
          }
        },
        {
          "name": "‚ûï Crear Sucursal",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"query\": \"mutation CrearSucursal($input: SucursalInput!) { crearSucursal(input: $input) { id_sucursal nombre direccion ciudad telefono created_at } }\",\n  \"variables\": {\n    \"input\": {\n      \"nombre\": \"Sucursal Central\",\n      \"direccion\": \"Av. Javier Prado 1234\",\n      \"ciudad\": \"Lima\",\n      \"telefono\": \"01-2345678\"\n    }\n  }\n}"
            },
            "url": {
              "raw": "{{base_url}}/graphql",
              "host": ["{{base_url}}"],
              "path": ["graphql"]
            }
          }
        },
        {
          "name": "‚ûï Crear Usuario",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"query\": \"mutation CrearUsuario($input: UserInput!) { crearUsuario(input: $input) { id name email created_at } }\",\n  \"variables\": {\n    \"input\": {\n      \"name\": \"Carlos Admin\",\n      \"email\": \"carlos.admin@empresa.com\",\n      \"password\": \"password123\",\n      \"rol_id\": \"1\"\n    }\n  }\n}"
            },
            "url": {
              "raw": "{{base_url}}/graphql",
              "host": ["{{base_url}}"],
              "path": ["graphql"]
            }
          }
        },
        {
          "name": "‚ûï Crear Rol",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"query\": \"mutation CrearRol($input: RolInput!) { crearRol(input: $input) { id_rol nombre descripcion created_at } }\",\n  \"variables\": {\n    \"input\": {\n      \"nombre\": \"Supervisor\",\n      \"descripcion\": \"Supervisor de operaciones\"\n    }\n  }\n}"
            },
            "url": {
              "raw": "{{base_url}}/graphql",
              "host": ["{{base_url}}"],
              "path": ["graphql"]
            }
          }
        },
        {
          "name": "üîó Asignar Veh√≠culo a Sucursal",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"query\": \"mutation AsignarVehiculo($input: VehiculoSucursalInput!) { asignarVehiculoSucursal(input: $input) { id id_vehiculo id_sucursal fecha_asignacion created_at } }\",\n  \"variables\": {\n    \"input\": {\n      \"id_vehiculo\": \"1\",\n      \"id_sucursal\": \"1\",\n      \"fecha_asignacion\": \"2025-07-26T10:00:00Z\"\n    }\n  }\n}"
            },
            "url": {
              "raw": "{{base_url}}/graphql",
              "host": ["{{base_url}}"],
              "path": ["graphql"]
            }
          }
        }
      ]
    },
    {
      "name": "üîÑ MUTATIONS - ACTUALIZAR DATOS",
      "item": [
        {
          "name": "‚úèÔ∏è Actualizar Empleado",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"query\": \"mutation ActualizarEmpleado($id: ID!, $input: EmpleadoInput!) { actualizarEmpleado(id_empleado: $id, input: $input) { id_empleado nombre cargo correo telefono updated_at } }\",\n  \"variables\": {\n    \"id\": \"1\",\n    \"input\": {\n      \"nombre\": \"Juan Carlos ACTUALIZADO\",\n      \"apellido\": \"P√©rez Garc√≠a\",\n      \"dni\": \"12345678\",\n      \"telefono\": \"999888777\",\n      \"id_rol\": \"1\"\n    }\n  }\n}"
            },
            "url": {
              "raw": "{{base_url}}/graphql",
              "host": ["{{base_url}}"],
              "path": ["graphql"]
            }
          }
        },
        {
          "name": "üöó Cambiar Estado de Veh√≠culo",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"query\": \"mutation CambiarEstado($id: ID!, $estado: String!) { cambiarEstadoVehiculo(id_vehiculo: $id, estado: $estado) { id_vehiculo placa estado updated_at } }\",\n  \"variables\": {\n    \"id\": \"1\",\n    \"estado\": \"ocupado\"\n  }\n}"
            },
            "url": {
              "raw": "{{base_url}}/graphql",
              "host": ["{{base_url}}"],
              "path": ["graphql"]
            }
          }
        },
        {
          "name": "‚úèÔ∏è Actualizar Sucursal",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"query\": \"mutation ActualizarSucursal($id: ID!, $input: SucursalInput!) { actualizarSucursal(id_sucursal: $id, input: $input) { id_sucursal nombre direccion ciudad telefono updated_at } }\",\n  \"variables\": {\n    \"id\": \"1\",\n    \"input\": {\n      \"nombre\": \"Sucursal Central RENOVADA\",\n      \"direccion\": \"Av. Javier Prado 1234 - Nuevo Local\",\n      \"ciudad\": \"Lima\",\n      \"telefono\": \"01-9876543\"\n    }\n  }\n}"
            },
            "url": {
              "raw": "{{base_url}}/graphql",
              "host": ["{{base_url}}"],
              "path": ["graphql"]
            }
          }
        }
      ]
    },
    {
      "name": "üê∞ RABBITMQ - MICROSERVICIOS",
      "item": [
        {
          "name": "üîç Estado de RabbitMQ (Health Check)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/rabbitmq/health",
              "host": ["{{base_url}}"],
              "path": ["api", "rabbitmq", "health"]
            }
          }
        },
        {
          "name": "üì§ Enviar Evento de Empleado",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"entity_type\": \"empleado\",\n  \"action\": \"created\",\n  \"data\": {\n    \"id_empleado\": \"EMP-001\",\n    \"nombre\": \"Mar√≠a L√≥pez\",\n    \"cargo\": \"Conductora\",\n    \"correo\": \"maria.lopez@empresa.com\",\n    \"telefono\": \"987654321\"\n  }\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/rabbitmq/publish",
              "host": ["{{base_url}}"],
              "path": ["api", "rabbitmq", "publish"]
            }
          }
        },
        {
          "name": "üì§ Enviar Evento de Veh√≠culo",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"entity_type\": \"vehiculo\",\n  \"action\": \"status_changed\",\n  \"data\": {\n    \"id_vehiculo\": \"VEH-001\",\n    \"placa\": \"XYZ-9876\",\n    \"marca\": \"Honda\",\n    \"modelo\": \"Civic\",\n    \"estado_anterior\": \"disponible\",\n    \"estado_nuevo\": \"mantenimiento\"\n  }\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/rabbitmq/publish",
              "host": ["{{base_url}}"],
              "path": ["api", "rabbitmq", "publish"]
            }
          }
        },
        {
          "name": "üì§ Enviar Evento de Asignaci√≥n",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"entity_type\": \"vehiculo_sucursal\",\n  \"action\": \"assigned\",\n  \"data\": {\n    \"id_vehiculo\": \"VEH-001\",\n    \"id_sucursal\": \"SUC-001\",\n    \"fecha_asignacion\": \"2025-07-26T15:30:00Z\",\n    \"empleado_responsable\": \"EMP-001\"\n  }\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/rabbitmq/publish",
              "host": ["{{base_url}}"],
              "path": ["api", "rabbitmq", "publish"]
            }
          }
        },
        {
          "name": "üìä Estad√≠sticas de Colas RabbitMQ",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/rabbitmq/stats",
              "host": ["{{base_url}}"],
              "path": ["api", "rabbitmq", "stats"]
            }
          }
        }
      ]
    },
    {
      "name": "üéØ PRUEBAS COMPLETAS",
      "item": [
        {
          "name": "üîÑ Flujo Completo: Crear Empleado + Evento",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"empleado\": {\n    \"nombre\": \"Pedro\",\n    \"apellido\": \"Ram√≠rez\",\n    \"dni\": \"87654321\",\n    \"telefono\": \"912345678\",\n    \"id_rol\": \"1\"\n  },\n  \"publish_event\": true\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/test/create-empleado-with-event",
              "host": ["{{base_url}}"],
              "path": ["api", "test", "create-empleado-with-event"]
            }
          }
        },
        {
          "name": "üöó Flujo Completo: Crear Veh√≠culo + Asignar + Evento",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"vehiculo\": {\n    \"placa\": \"DEF-5678\",\n    \"marca\": \"Nissan\",\n    \"modelo\": \"Sentra\",\n    \"anio\": 2024,\n    \"tipo_id\": \"sedan\",\n    \"estado\": \"disponible\"\n  },\n  \"sucursal_id\": \"1\",\n  \"publish_events\": true\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/test/create-vehiculo-assign-with-events",
              "host": ["{{base_url}}"],
              "path": ["api", "test", "create-vehiculo-assign-with-events"]
            }
          }
        },
        {
          "name": "üìä Dashboard Data (Todas las entidades)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/dashboard/data",
              "host": ["{{base_url}}"],
              "path": ["api", "dashboard", "data"]
            }
          }
        }
      ]
    }
  ],
  "variable": [
    {
      "key": "base_url",
      "value": "http://127.0.0.1:8000",
      "type": "string"
    }
  ]
}
